# 문제 제목: [27981 압도적 XOR 수](https://www.acmicpc.net/problem/27981)
- **플랫폼**: 백준
- **난이도**: 7/10
- **풀이 유형**: 수학

---

## 1. 문제 요약
- 문제 핵심:
  - 양의 정수 $A$에 대해 $A$보다 큰 $2$의 제곱수 중 가장 작은 값을 $P$라고 할 때, $B = A \oplus (P-1)$ 로 정의하자.
  - 이 때, 양의 정수 $K$에 대해 $A \geq B \times (2^K-1)$일 경우 $A$를 압도적 XOR 수라고 한다.
  - $1 \leq A \leq N$을 만족시키는 $A$의 개수를 구하라.
  - $a \oplus b$는 $a$와 $b$의 bitwise XOR로 계산한다.
- 입력/출력 조건: 
- 제한 조건: $1 \leq N \leq 10^{15}$

---

## 2. 접근 아이디어
- 자력 풀이 시도:
  - $B = A \oplus (P-1)$에서 P는 11..1(A의 비트개수)이고 이것을 xor하면 ~A형식이 된다.(부호비트는 안 뒤집고) 이렇게 되면 $A+B=P-1$, $A=P-1-B$로 된다
  - $A \geq B \times (2^K-1)$에서 $A$에 $A=P-1-B$을 대입한후 식을 정리하면 $P-1-B \geq B \times (2^K-1)$, $P-1 \geq B \times 2^K$ 가 되고 $A$의 비트길이를 $L$이라고 할때 $P-1$은 $2^L-1이 되므로 $2^L-1 \geq B \times 2^K$, $(2^L-1)/2^K \geq B$가 된다. 
  - 예제와 내가 아는 xor의 성질을 통해 3가지 케이스로 나누었다.
  - $K = 1$인 경우 -> $A \leq B$가 된다. $B$는 $A$에서 최상위 비트가 0이므로 $A > B$를 항상만족한다. 따라서 이경우는 압도적 XOR수는 N개 이다.
  - $K > 1 and B = 0$인 경우 -> $A \leq 0$이 된다. 항상 참인경우가 된다. $B$가 0이 되려면 A는 $2^t - 1 (t>1)$꼴이어야 한다.
  - $K > 1 and B > 1$인 경우 -> $(2^L-1)/2^K \geq B > 1$ ($\geq$가 아닌이유는 위 경우에서 배재되기 때문)을 만족시키는 $A(B)$(A와B는 일대일대응이기때문)개수가 된다.
- 막혔던 포인트:
  - $K > 1 and B > 1$인 경우를 어떻게 $N$에 대한 식으로 나타낼때 막혔다.
- 답지 참고 후:
  - $A$의 비트길이를 $L$이라고 했을때 비트길이가 L보다 작은 경우 -> $K > 1 and B = 0$인 경우와 $K > 1 and B > 1$인 경우경우를 더하면 된다.
    -  $\sum_{i=1}^{L-1} (\lfloor \frac{2^i-1}{2^K} \rfloor + 1)$
  - $A$의 비트길이를 $L$이라고 했을때 비트길이가 L보다 같은 경우 -> $A=2^L-1-B$형태인데 $A \leq N$이므로 $N \geq 2^L-1-B$, $B \geq 2^L-1-N$가 되고 위에 구했던 $(2^L-1)/2^K \geq B$와 합치면 $(2^L-1)/2^K \geq B \geq 2^L-1-N$꼴이 되고 만족시키는 B의 개수는 $((2^L-1)/2^K)-(2^L-1-N)$이 0 이상일떄 $((2^L-1)/2^K)-(2^L-1-N)+1$이 된다.


---

## 3. 코드 정리
[정답 코드](./answer.py)

---

## 4. 시간/공간 복잡도

* 시간: O( log N )
* 공간: O(  1 )

---

## 5. 배운 점 / 실수

* XOR의 기본 성질과 비트연산과 사칙연산의 관계를 배웠다.
* A + ~A (A는 부호없는 정수)에 대해 알게 되었다.
* 수학적으로 식을 엄밀하게 증명하는 방법에 대해 조금더 알게되었다.
* 특정 수 N까지의 개수를 세는 문제를 풀 때, N의 표현(진법, 비트 등)을 기준으로 범위를 나누어 계산하는 기법을 배웠다.

